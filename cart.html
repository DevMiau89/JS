<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>First Script</title>
    // Odniesienie do skryptu w internecie
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
    <h1>Shopping Cart</h1>

    <div>
        <ul>
            <li><a class="add-to-cart" href="#" data-name="Apple" data-price="1.22">"Apple $1.22"</a></li>
            <li><a class="add-to-cart" href="#" data-name="Banana" data-price="1.22">"Banana $1.33"</a></li>
            <li><a class="add-to-cart" href="#" data-name="Banana" data-price="1.22">"Shoe $22.33"</a></li>
            <li><a class="add-to-cart" href="#" data-name="Frisbee" data-price="5.22">"Frisbee $5.22"</a></li>
        </ul>
        <button id="clear-cart">Clear Cart</button>
    </div>

    <div>
        <ul id="show-cart">
            <!-- -->
        </ul>
    </div>

    <script language = "Javascript">

        $(".add-to-cart").click(function(event){
            event.preventDefault();
            var name = $(this).attr("data-name");
            var price = Number($(this).attr("data-price"));
            addItemToCart(name, price, 1);
            displayCart();
        });

        function displayCart() {
            console.log("*** Display Cart ***");

            var cartArray = listCart();
            console.log("*** Count Cart:" + cartArray.length);

            var output = "";
            for (var i in cartArray) {
                output += "<li>" + cartArray[i].name + " " + cartArray[i].count + "</li>";
            }
            $("#show-cart").html(output);
        }


        //***************************************
        // Shopping Cart functions

        var cart = [];

        var Item = function(name, price, count){
            this.name = name
            this.price = price
            this.count = count
        };

        function addItemToCart(name, price, count){
            for (var i in cart) {
                if (cart[i].name === name) {
                    cart[i].count += count;
                    return;
                }
            }
            var item = new Item(name, price, count);
            cart.push(item);
            saveCart();
        }


        function removeItemFromCart(name) { // removes one item
            for (var i in cart) {
                if (cart[i].name === name) {
                    cart[i].count --;
                    if (cart[i].count === 0) {
                        cart.spice( i, 1);
                    }
                    return;
                }
            }
            saveCart();
        }

        function removeItemFromCartAll(name) {  // removes all item name
            for( var i in cart ) {
                if(cart[i].name === name) {
                    cart.splice(i, 1);
                    return;
                }
            }
            saveCart();
        }

        function clearCart() {
            cart = [];
            saveCart();
        }

        function countCart() {   //-> return total count
            var totalCount = 0;
            for (var i in cart) {
                totalCount += cart[i].count;
            }

            return totalCount;
        }

        console.log( countCart() );

        function totalCost(){ //-> return total cost
            var totalCost = 0;
            for (var i in cart) {
                totalCost += cart[i].price
            }
            return totalCost;
        }

        console.log( totalCost() );

        function  listCart() {  //-> array of Items
            var cartCopy = [];
            for (var i in cart) {
                var item = cart[i];
                var itemCopy = {};
                for (var p in item) {
                    itemCopy[p] = item[p];
                }
                cartCopy.push(itemCopy);
            }
            return cartCopy;
        }

        console.log( listCart() );


        function saveCart() {
            localStorage.setItem("shoppingCart", JSON.stringify(cart));
        }

        function loadCart() {
            cart = JSON.parse(localStorage.getItem("shoppingCart"));
        }

        loadCart();

        var array = listCart();
        console.log(array);

    </script>
</body>
</html>
